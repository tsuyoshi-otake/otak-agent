<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">
    <Package Name="otak-agent"
             Language="1033"
             Version="1.0.0.0"
             Manufacturer="Tsuyoshi Otake"
             UpgradeCode="B3F5E2A1-8C7D-4F9E-A123-456789ABCDEF">

        <MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />

        <Media Id="1" Cabinet="otak-agent.cab" EmbedCab="yes" />

        <StandardDirectory Id="ProgramFilesFolder">
            <Directory Id="INSTALLFOLDER" Name="otak-agent">
                <Component Id="MainExecutable" Guid="B1C2D3E4-F5A6-7890-BCDE-F12345678901">
                    <File Id="OtakAgentAppExe" Source="publish\OtakAgent.App.exe" KeyPath="yes">
                        <Shortcut Id="startmenuShortcut"
                                  Directory="ProgramMenuFolder"
                                  Name="otak-agent"
                                  Description="AI-powered Desktop Assistant"
                                  WorkingDirectory="INSTALLFOLDER"
                                  Icon="AppIcon"
                                  Advertise="yes" />
                    </File>
                </Component>

                <Component Id="CoreLibrary" Guid="C1D2E3F4-A5B6-7890-CDEF-123456789012">
                    <File Id="OtakAgentCoreDll" Source="publish\OtakAgent.Core.dll" />
                </Component>

                <Component Id="AppRuntimeConfig" Guid="D1E2F3A4-B5C6-7890-DEF0-234567890123">
                    <File Id="AppRuntimeConfig" Source="publish\OtakAgent.App.runtimeconfig.json" />
                </Component>

                <Component Id="AppDepsJson" Guid="E1F2A3B4-C5D6-7890-EF01-345678901234">
                    <File Id="AppDepsJson" Source="publish\OtakAgent.App.deps.json" />
                </Component>

                <Directory Id="ResourcesFolder" Name="Resources">
                    <Component Id="ResourceFiles" Guid="F1A2B3C4-D5E6-7890-F012-456789012345">
                        <File Id="ClippyGif" Source="publish\Resources\clippy.gif" />
                        <File Id="ClippyStartGif" Source="publish\Resources\clippy_start.gif" />
                        <File Id="ClippyWav" Source="publish\Resources\clippy.wav" />
                        <File Id="KairuGif" Source="publish\Resources\kairu.gif" />
                        <File Id="KairuStartGif" Source="publish\Resources\kairu_start.gif" />
                        <File Id="KairuWav" Source="publish\Resources\kairu.wav" />
                        <File Id="MenuCommandWav" Source="publish\Resources\menucommand.wav" />
                        <File Id="WindowTopPng" Source="publish\Resources\windowTop.png" />
                        <File Id="WindowCenterPng" Source="publish\Resources\windowCenter.png" />
                        <File Id="WindowBottomPng" Source="publish\Resources\windowBottom.png" />
                    </Component>
                </Directory>
            </Directory>
        </StandardDirectory>

        <StandardDirectory Id="ProgramMenuFolder" />

        <Icon Id="AppIcon" SourceFile="publish\OtakAgent.App.exe" />

        <Property Id="ARPPRODUCTICON" Value="AppIcon" />
        <Property Id="ARPHELPLINK" Value="https://github.com/tsuyoshi-otake/otak-agent/issues" />
        <Property Id="ARPURLINFOABOUT" Value="https://tsuyoshi-otake.github.io/otak-agent/" />

        <Feature Id="MainApplication" Title="otak-agent" Level="1">
            <ComponentRef Id="MainExecutable" />
            <ComponentRef Id="CoreLibrary" />
            <ComponentRef Id="AppRuntimeConfig" />
            <ComponentRef Id="AppDepsJson" />
            <ComponentRef Id="ResourceFiles" />
        </Feature>

    </Package>
</Wix>